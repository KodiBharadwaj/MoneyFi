<div class="admin-container">
  <nav class="top-nav">
    <div class="brand">MoneyFi Admin</div>
  </nav>

  <div class="layout">
    <aside class="side-nav">
      <ul class="nav-list">
        <li routerLink="/admin/home">Dashboard</li>
        <li [routerLink]="['/admin/users', 'All']">Total Users</li>
        <li [routerLink]="['/admin/requests', 'All']">User Requests</li>
        <li routerLink="/admin/user-defects">User Issues</li>
        <li routerLink="/admin/feedbacks">User Feedbacks</li>
        <li routerLink="/admin/insights">Insights/Charts</li>
        <li routerLink="/admin/configuration">Configuration</li>
      </ul>
      <ul class="logout-list">
        <li (click)="logoutUser()">Logout</li>
      </ul>
    </aside>

    <div class="table-container">
      

      <ng-template #loadingTpl>
      <div *ngIf="isGridLoading; else noRequests" class="grid-loader">
        <span class="spinner"></span> Loading requests...
      </div>
    </ng-template>

      <table class="user-table" *ngIf="requests.length > 0; else loadingTpl">
        <thead>
          <tr>
            <th>Username</th>
            <th>Request Type</th>
            <th>Name</th>
            <th>Description</th>
            <th>Image</th>
            <th>Reference Number</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let request of requests">
            <td>{{ request.username }}</td>
            <td>{{ request.requestType }}</td>
            <td>{{ request.name }}</td>
            <td>{{ request.description }}</td>
            <td> 
              <!-- Image -->
              <div class="image-preview" (click)="viewImage(request.username, request.requestId)">
                <img src="assets/image-placeholder.png" alt="View" />
                <p class="click-text">Click to view image</p>
              </div>
            </td>
            <td>
              <span class="ref-text">{{ request.referenceNumber }}</span>
              <button class="copy-btn" (click)="copyToClipboard(request.referenceNumber)">ðŸ“‹</button>
            </td>
            <td>
              <div class="action-buttons">
                <button class="approve-btn" (click)="approveUserRequest(request, status)">Approve</button>
                <button class="decline-btn" (click)="declineUserRequest(request, status)">Decline</button>
              </div>
            </td>

          </tr>
        </tbody>
      </table>
    </div>

    <ng-template #noRequests>
      <div class="no-data">No user requests found.</div>
    </ng-template>
  </div>

  <!-- Modal -->
  <div *ngIf="selectedImage" class="image-modal">
    <div class="modal-content">
      <span class="close-btn" (click)="selectedImage = null">&times;</span>
      <img [src]="selectedImage" alt="Defect Image" />
    </div>
  </div>
</div>
