<div class="admin-container">
  <nav class="top-nav">
    <div class="brand">MoneyFi Admin</div>
  </nav>

  <div class="layout">
    <aside class="side-nav">
      <ul class="nav-list">
        <li routerLink="/admin/home">Dashboard</li>
        <li [routerLink]="['/admin/users', 'All']">Total Users</li>
        <li [routerLink]="['/admin/requests', 'All']">User Requests</li>
        <li routerLink="/admin/user-defects">User Issues</li>
        <li routerLink="/admin/feedbacks">User Feedbacks</li>
        <li routerLink="/admin/insights">Insights/Charts</li>
        <li routerLink="/admin/configuration">Configuration</li>
      </ul>
      <ul class="logout-list">
        <li (click)="logoutUser()">Logout</li>
      </ul>
    </aside>

    <!-- <main class="main-content">
      
    </main> -->
    <main class="main-content">
      <!-- Filter Controls -->
      <div class="filter-bar">
        <div
          class="status-filter"
          [class.selected]="selectedStatus === 'All'"
          (click)="filterStatus('All')">
          All
        </div>
        <div
          class="status-filter"
          [class.selected]="selectedStatus === 'COMPLETED'"
          (click)="filterStatus('COMPLETED')">
          Solved
        </div>
        <div
          class="status-filter"
          [class.selected]="selectedStatus === 'PENDED'"
          (click)="filterStatus('PENDED')">
          Pend
        </div>
        <div
          class="status-filter"
          [class.selected]="selectedStatus === 'IGNORED'"
          (click)="filterStatus('IGNORED')">
          Ignore
        </div>
        <div
          class="status-filter"
          [class.selected]="selectedStatus === 'All'"
          style="margin-left: auto;"
          (click)="resetFilterManually()">
          Reset
        </div>

      </div>


      <!-- Reason Dialog -->
<div *ngIf="showReasonDialog" class="reason-modal">
  <div class="modal-content">
    <h3>Select Reason for Ignoring</h3>
    
    <select [(ngModel)]="selectedReason">
      <option *ngFor="let reason of reasons" [value]="reason">{{ reason }}</option>
    </select>

    <!-- Show text input for "Other" -->
    <input 
      *ngIf="selectedReason === 'Other'" 
      type="text" 
      [(ngModel)]="customReason"
      placeholder="Enter custom reason" />

    <div class="modal-actions">
      <button (click)="submitIgnoreReason()">Submit</button>
      <button (click)="showReasonDialog = false">Cancel</button>
    </div>
  </div>
</div>

      <!-- Defects List -->
      <div class="defects-container" *ngIf="filteredDefects.length > 0">
        <div class="defect-card" *ngFor="let defect of filteredDefects">
          <h3>{{ defect.name }}</h3>
          <p><strong>Username:</strong> {{ defect.username }}</p>
          <p><strong>Reference No:</strong> {{ defect.referenceNumber }}</p>
          <p><strong>Description:</strong> {{ defect.description }}</p>
          <p><strong>Status:</strong> {{ defect.defectStatus }}</p>

          <!-- Image -->
          <div class="image-preview" (click)="viewImage(defect.username, defect.defectId)">
            <img src="assets/image-placeholder.png" alt="View" />
            <p class="click-text">Click to view image</p>
          </div>

          <!-- Status Update Buttons -->
          <div class="status-buttons">
            <button
              [disabled]="defect.defectStatus === 'COMPLETED' || defect.defectStatus === 'IGNORED'"
              (click)="updateDefectStatus(defect.defectId, 'Solved')">
              Solve
            </button>

            <button
              [disabled]="defect.defectStatus === 'COMPLETED' || defect.defectStatus === 'PENDED' || defect.defectStatus === 'IGNORED'"
              (click)="updateDefectStatus(defect.defectId, 'Pend')">
              Pend
            </button>

            <button
              [disabled]="defect.defectStatus === 'COMPLETED' || defect.defectStatus === 'IGNORED'"
              (click)="updateDefectStatus(defect.defectId, 'Ignore')">
              Ignore
            </button>
          </div>

        </div>
      </div>

      <!-- Modal -->
      <div *ngIf="selectedImage" class="image-modal">
        <div class="modal-content">
          <span class="close-btn" (click)="selectedImage = null">&times;</span>
          <img [src]="selectedImage" alt="Defect Image" />
        </div>
      </div>
    </main>
  </div>
</div>
